<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ToastCaseScenario - KI-Feedback f√ºr Zivilrechtsklausuren</title>
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;600;700&family=Crimson+Text:ital,wght@0,400;0,600;1,400&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="css/style.css">
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üå≠‚öñÔ∏èWurstCaseScenario</h1>
            <p>KI-Feedback f√ºr Zivilrechtsklausuren</p>
        </div>

        <div class="card">
            <h2>Fall ausw√§hlen</h2>
            <div class="form-group">
                <label for="caseSelect">W√§hle einen Fall:</label>
                <select id="caseSelect">
                    <option value="">-- Bitte w√§hlen --</option>
                    <option value="A">Fall A: Ein hei√üer Hund</option>
                    <option value="B">Fall B: Ein teurer Tropfen</option>
                </select>
                <div id="factsBox" class="facts-box" style="display: none;">
                    <img id="caseImage" src="" alt="Fall-Bild"
                         style="max-width:100%; margin-bottom:15px; border-radius:10px; display:none;">
                    <div id="factsText"></div>
                </div>
            </div>
        </div>

        <div class="card">
            <h2>Deine L√∂sung</h2>
            <div class="form-group">
                <label for="solutionText">L√∂sung eingeben oder Datei hochladen:</label>
                <textarea id="solutionText" placeholder="Gib hier deine Falll√∂sung ein..."></textarea>
                <div class="counter" id="textCounter">0 W√∂rter, 0 Zeichen</div>
                <div class="button-group">
                    <input type="file" id="fileInput" accept=".txt" style="display: none;">
                    <button type="button" class="btn btn-secondary" onclick="document.getElementById('fileInput').click();">üìÑ .txt importieren</button>
                    <button type="button" class="btn btn-secondary" onclick="resetSolution()">üóëÔ∏è Zur√ºcksetzen</button>
                </div>
            </div>
        </div>

        <div class="card">
            <h2>Auswertung</h2>
            <button id="evaluateBtn" class="btn btn-primary" onclick="evaluateSolution()">
                <span id="evaluateText">üìä Bewerten</span>
                <div id="evaluateSpinner" class="spinner" style="display: none;"></div>
            </button>
        </div>

        <div id="resultCard" class="card result-card">
            <h2>Bewertungsergebnis</h2>
            <div class="score-section">
                <div id="totalScore" class="total-score">0 / 40</div>
                <div class="progress-bar"><div id="progressFill" class="progress-fill" style="width: 0%;"></div></div>
                <div id="subscores" class="subscores"></div>
            </div>
            <div id="feedbackSection" class="feedback-section"></div>
            <div class="button-group" style="margin-top: 30px;">
                <button type="button" class="btn btn-secondary" onclick="window.print()">üñ®Ô∏è PDF speichern</button>
                <button type="button" class="btn btn-primary" onclick="openFeedbackOverlay()">üí¨ Feedback geben</button>
            </div>
        </div>
    </div>

    <div id="feedbackOverlay" class="overlay">
        <div class="overlay-content">
            <h2 style="font-family: 'Playfair Display', serif; margin-bottom: 25px; color: var(--text-dark);">Feedback zur Bewertung</h2>
            <div class="privacy-notice">
                <strong>Datenschutz:</strong> 
                Durch das Ausf√ºllen des untenstehenden Formulars hilfst du uns, die Wirtschaftlichkeit und Relevanz dieses Projekts besser zu beurteilen und es weiterzuentwickeln. Daf√ºr danken wir dir von &#x2764;.<br><br>
                
                Dein Feedback wird <strong>anonym</strong> verarbeitet, √ºber unseren Make-Webhook √ºbermittelt und in Google Sheets gespeichert. 
                <br><br>
                Nur wenn du unten ausdr√ºcklich zustimmst, speichern wir zus√§tzlich deine E-Mail-Adresse, um dich √ºber zuk√ºnftige Entwicklungen des Projekts zu informieren. 
                <br><br>
                Ohne deine Zustimmung wird keine E-Mail-Adresse gespeichert. 
                <br><br>
                Weitere Informationen zum Umgang mit personenbezogenen Daten findest du in unserer <a href="/datenschutzerklaerung" target="_blank">Datenschutzerkl√§rung</a>.
            </div>
            <form class="feedback-form" onsubmit="submitFeedback(event)">
                <div class="form-group">
                    <label>War das Feedback hilfreich?</label>
                    <div class="rating-group">
                        <button type="button" class="rating-btn" data-helpful="true" onclick="selectHelpful(true)">Ja</button>
                        <button type="button" class="rating-btn" data-helpful="false" onclick="selectHelpful(false)">Nein</button>
                    </div>
                </div>
                <div class="form-group">
                    <label for="feedbackGood">Was war gut?</label>
                    <textarea id="feedbackGood" placeholder="Was hat dir gefallen?" rows="2"></textarea>
                </div>
                <div class="form-group">
                    <label for="feedbackBad">Was war schlecht?</label>
                    <textarea id="feedbackBad" placeholder="Was hat dir nicht gefallen?" rows="2"></textarea>
                </div>
                <div class="form-group">
                    <label for="feedbackFeatures">Zus√§tzliche Features / Ideen?</label>
                    <textarea id="feedbackFeatures" placeholder="Welche Funktionen oder Ideen w√ºrdest du dir w√ºnschen?" rows="2"></textarea>
                </div>
                <div class="form-group">
                    <label for="feedbackGeneral">Generelles Feedback</label>
                    <textarea id="feedbackGeneral" placeholder="Dein allgemeines Feedback..." rows="2"></textarea>
                </div>
                <div class="form-group">
                    <label>Wie wahrscheinlich w√ºrdest du WurstCaseScenario weiterempfehlen? (1-5)</label>
                    <div class="rating-group">
                        <button type="button" class="rating-btn" data-likelihood="1" onclick="selectLikelihood(1)">1</button>
                        <button type="button" class="rating-btn" data-likelihood="2" onclick="selectLikelihood(2)">2</button>
                        <button type="button" class="rating-btn" data-likelihood="3" onclick="selectLikelihood(3)">3</button>
                        <button type="button" class="rating-btn" data-likelihood="4" onclick="selectLikelihood(4)">4</button>
                        <button type="button" class="rating-btn" data-likelihood="5" onclick="selectLikelihood(5)">5</button>
                    </div>
                </div>
                <div class="form-group">
                    <label>Kannst du dir vorstellen, f√ºr ein Abo-Modell zu zahlen?</label>
                    <div class="rating-group">
                        <button type="button" class="rating-btn" data-subscription="yes" onclick="selectSubscription('yes')">Ja</button>
                        <button type="button" class="rating-btn" data-subscription="no" onclick="selectSubscription('no')">Nein</button>
                        <button type="button" class="rating-btn" data-subscription="maybe" onclick="selectSubscription('maybe')">Vielleicht</button>
                    </div>
                </div>
                <div class="form-group">
                    <label>Interessiert an weiteren Iterationen des Projekts und Einwilligung zur Speicherung der E-Mail f√ºr sp√§tere Infos?</label>
                    <div class="rating-group">
                        <button type="button" class="rating-btn" data-consent="yes" onclick="selectConsent(true)">Ja</button>
                        <button type="button" class="rating-btn" data-consent="no" onclick="selectConsent(false)">Nein</button>
                    </div>
                </div>
                <div class="form-group" id="emailGroup" style="display:none;">
                    <label for="feedbackEmail">E-Mail (optional, nur bei Einwilligung):</label>
                    <input type="email" id="feedbackEmail" placeholder="deine@email.de" autocomplete="email">
                </div>
                <div class="button-group">
                    <button type="button" class="btn btn-secondary" onclick="closeFeedbackOverlay()">Abbrechen</button>
                    <button type="submit" class="btn btn-primary">
                        <span id="feedbackSubmitText">Feedback senden</span>
                        <div id="feedbackSpinner" class="spinner" style="display: none;"></div>
                    </button>
                </div>
            </form>
        </div>
    </div>

    <div class="footer">
        <p>
            <a href="mailto:info@wurstcasescenario.de">Kontakt</a> |
            <a href="#" onclick="alert('Impressum: Wurst, Beispielstra√üe 123, 12345 Musterstadt')">Impressum</a> |
            <a href="#" onclick="alert('Datenschutz: Nur anonyme Daten werden verarbeitet.')">Datenschutz</a>
        </p>
        <p style="margin-top: 15px;"><strong>Wichtiger Hinweis:</strong> Diese Anwendung dient nur zu √úbungszwecken und stellt keine Rechtsberatung dar.</p>
    </div>

    <div id="toastContainer" class="toast-container"></div>

    <script src="js/main.js"></script>
</body>
</html>
