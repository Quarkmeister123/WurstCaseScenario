<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ToastCaseScenario - KI-Feedback für Zivilrechtsklausuren</title>
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;600;700&family=Crimson+Text:ital,wght@0,400;0,600;1,400&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="css/style.css">
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>🌭⚖️WurstCaseScenario</h1>
            <p>KI-Feedback für Zivilrechtsklausuren</p>
        </div>

        <div class="card">
            <h2>Fall auswählen</h2>
            <div class="form-group">
                <label for="caseSelect">Wähle einen Fall:</label>
                <select id="caseSelect">
                    <option value="">-- Bitte wählen --</option>
                    <option value="A">Fall A: Ein heißer Hund</option>
                    <option value="B">Fall B: Ein teurer Tropfen</option>
                </select>
                <div id="factsBox" class="facts-box" style="display: none;">
                    <img id="caseImage" src="" alt="Fall-Bild"
                         style="max-width:100%; margin-bottom:15px; border-radius:10px; display:none;">
                    <div id="factsText"></div>
                </div>
            </div>
        </div>

        <div class="card">
            <h2>Deine Lösung</h2>
            <div class="form-group">
                <label for="solutionText">Lösung eingeben oder Datei hochladen:</label>
                <textarea id="solutionText" placeholder="Gib hier deine Falllösung ein..."></textarea>
                <div class="counter" id="textCounter">0 Wörter, 0 Zeichen</div>
                <div class="button-group">
                    <input type="file" id="fileInput" accept=".txt" style="display: none;">
                    <button type="button" class="btn btn-secondary" onclick="document.getElementById('fileInput').click();">📄 .txt importieren</button>
                    <button type="button" class="btn btn-secondary" onclick="resetSolution()">🗑️ Zurücksetzen</button>
                </div>
            </div>
        </div>

        <div class="card">
            <h2>Auswertung</h2>
            <button id="evaluateBtn" class="btn btn-primary" onclick="evaluateSolution()">
                <span id="evaluateText">📊 Bewerten</span>
                <div id="evaluateSpinner" class="spinner" style="display: none;"></div>
            </button>
        </div>

        <div id="resultCard" class="card result-card">
            <h2>Bewertungsergebnis</h2>
            <div class="score-section">
                <div id="totalScore" class="total-score">0 / 40</div>
                <div class="progress-bar"><div id="progressFill" class="progress-fill" style="width: 0%;"></div></div>
                <div id="subscores" class="subscores"></div>
            </div>
            <div id="feedbackSection" class="feedback-section"></div>
            <div class="button-group" style="margin-top: 30px;">
                <button type="button" class="btn btn-secondary" onclick="window.print()">🖨️ PDF speichern</button>
                <button type="button" class="btn btn-primary" onclick="openFeedbackOverlay()">💬 Feedback geben</button>
            </div>
        </div>
    </div>

    <div id="feedbackOverlay" class="overlay">
        <div class="overlay-content">
            <h2 style="font-family: 'Playfair Display', serif; margin-bottom: 25px; color: var(--text-dark);">Feedback zur Bewertung</h2>
            <div class="privacy-notice">
                <strong>Datenschutz:</strong> Dein Feedback wird anonym an unseren Make-Webhook gesendet und dort an Telegram/Spreadsheet weitergeleitet. Keine personenbezogenen Daten werden gespeichert.
            </div>
            <form class="feedback-form" onsubmit="submitFeedback(event)">
                <div class="form-group">
                    <label>War das Feedback hilfreich?</label>
                    <div class="rating-group">
                        <button type="button" class="rating-btn" data-helpful="true" onclick="selectHelpful(true)">Ja</button>
                        <button type="button" class="rating-btn" data-helpful="false" onclick="selectHelpful(false)">Nein</button>
                    </div>
                </div>
                <div class="form-group">
                    <label>Wie wahrscheinlich würdest du WurstCaseScenario weiterempfehlen? (1-5)</label>
                    <div class="rating-group">
                        <button type="button" class="rating-btn" data-likelihood="1" onclick="selectLikelihood(1)">1</button>
                        <button type="button" class="rating-btn" data-likelihood="2" onclick="selectLikelihood(2)">2</button>
                        <button type="button" class="rating-btn" data-likelihood="3" onclick="selectLikelihood(3)">3</button>
                        <button type="button" class="rating-btn" data-likelihood="4" onclick="selectLikelihood(4)">4</button>
                        <button type="button" class="rating-btn" data-likelihood="5" onclick="selectLikelihood(5)">5</button>
                    </div>
                </div>
                <div class="form-group">
                    <label for="feedbackComment">Zusätzliche Anmerkungen (optional):</label>
                    <textarea id="feedbackComment" placeholder="Was können wir verbessern?" rows="3"></textarea>
                </div>
                <div class="button-group">
                    <button type="button" class="btn btn-secondary" onclick="closeFeedbackOverlay()">Abbrechen</button>
                    <button type="submit" class="btn btn-primary">
                        <span id="feedbackSubmitText">Feedback senden</span>
                        <div id="feedbackSpinner" class="spinner" style="display: none;"></div>
                    </button>
                </div>
            </form>
        </div>
    </div>

    <div class="footer">
        <p>
            <a href="mailto:info@wurstcasescenario.de">Kontakt</a> |
            <a href="#" onclick="alert('Impressum: Wurst, Beispielstraße 123, 12345 Musterstadt')">Impressum</a> |
            <a href="#" onclick="alert('Datenschutz: Nur anonyme Daten werden verarbeitet.')">Datenschutz</a>
        </p>
        <p style="margin-top: 15px;"><strong>Wichtiger Hinweis:</strong> Diese Anwendung dient nur zu Übungszwecken und stellt keine Rechtsberatung dar.</p>
    </div>

    <div id="toastContainer" class="toast-container"></div>

    <script src="js/main.js"></script>
</body>
</html>
